name: Sync issues and PRs to Project 7

on:
  issues:
    types: [opened, reopened, labeled, unlabeled, edited]
  pull_request:
    types: [opened, reopened, ready_for_review, labeled, unlabeled, edited]
  workflow_dispatch:

# This workflow uses a PAT via secrets.PROJECTS_TOKEN because
# GitHub Projects (v2) requires GraphQL access beyond default GITHUB_TOKEN in some org/user setups.
# Create a classic PAT with project and repo scopes and add it as a repository secret named PROJECTS_TOKEN.

permissions:
  contents: read

jobs:
  add_to_project:
    # Do not fail PRs/Issues when PROJECTS_TOKEN is not configured (common for forks or fresh repos).
    if: >-
      ${{
        secrets.PROJECTS_TOKEN != '' &&
        (
          github.event_name != 'pull_request' ||
          github.event.pull_request.head.repo.fork == false
        )
      }}
    runs-on: ubuntu-latest
    steps:
      - name: Add item to GitHub Project 7
        uses: actions/add-to-project@v0.5.0
        with:
          project-url: https://github.com/users/mrbestnaija/projects/7
          github-token: ${{ secrets.PROJECTS_TOKEN }}


